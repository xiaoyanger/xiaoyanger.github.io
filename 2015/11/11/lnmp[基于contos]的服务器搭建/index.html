<!doctype html>



  


<html class="theme-next muse use-motion">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  
  
  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.0.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="mysql,php,nginx,linux," />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.0.1" />






<meta name="description" content="nginx+mysql+php=&amp;gt;lnmp服务器搭建[转自老马运维，十分感谢]centos:7.1.1503 64位系统nginx:1.8.0mysql:5.6.24php:5.6.8

根据生产环境安装操作系统（centos 7.1.1503 64位系统），安装完成后，使用Xshell通过ssh协议连接服务器。ssh 用户名@IP+回车+输入密码后登录系统。12$&amp;amp;: mkdir">
<meta property="og:type" content="article">
<meta property="og:title" content="lnmp服务器搭建">
<meta property="og:url" content="https://xiaoyanger.github.io/2015/11/11/lnmp[基于contos]的服务器搭建/index.html">
<meta property="og:site_name" content="myNote-Blog">
<meta property="og:description" content="nginx+mysql+php=&amp;gt;lnmp服务器搭建[转自老马运维，十分感谢]centos:7.1.1503 64位系统nginx:1.8.0mysql:5.6.24php:5.6.8

根据生产环境安装操作系统（centos 7.1.1503 64位系统），安装完成后，使用Xshell通过ssh协议连接服务器。ssh 用户名@IP+回车+输入密码后登录系统。12$&amp;amp;: mkdir">
<meta property="og:updated_time" content="2016-07-14T07:22:19.474Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="lnmp服务器搭建">
<meta name="twitter:description" content="nginx+mysql+php=&amp;gt;lnmp服务器搭建[转自老马运维，十分感谢]centos:7.1.1503 64位系统nginx:1.8.0mysql:5.6.24php:5.6.8

根据生产环境安装操作系统（centos 7.1.1503 64位系统），安装完成后，使用Xshell通过ssh协议连接服务器。ssh 用户名@IP+回车+输入密码后登录系统。12$&amp;amp;: mkdir">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Muse',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: 0,
      author: 'Author'
    }
  };
</script>




  <link rel="canonical" href="https://xiaoyanger.github.io/2015/11/11/lnmp[基于contos]的服务器搭建/"/>

  <title> lnmp服务器搭建 | myNote-Blog </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="">

  










  
  
    
  

  <div class="container one-collumn sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">myNote-Blog</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle"></p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Startseite
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archiv
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            Tags
          </a>
        </li>
      

      
    </ul>
  

  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                lnmp服务器搭建
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Veröffentlicht am</span>
            <time itemprop="dateCreated" datetime="2015-11-11T00:00:00+08:00" content="2015-11-11">
              2015-11-11
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2015/11/11/lnmp[基于contos]的服务器搭建/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2015/11/11/lnmp[基于contos]的服务器搭建/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>nginx+mysql+php=&gt;lnmp服务器搭建<br><a href="http://www.lmyw.net.cn/?p=487" target="_blank" rel="external">[转自老马运维，十分感谢]</a><br>centos:7.1.1503 64位系统<br>nginx:1.8.0<br>mysql:5.6.24<br>php:5.6.8</p>
<hr>
<h1 id="根据生产环境安装操作系统（centos-7-1-1503-64位系统），安装完成后，使用Xshell通过ssh协议连接服务器。"><a href="#根据生产环境安装操作系统（centos-7-1-1503-64位系统），安装完成后，使用Xshell通过ssh协议连接服务器。" class="headerlink" title="根据生产环境安装操作系统（centos 7.1.1503 64位系统），安装完成后，使用Xshell通过ssh协议连接服务器。"></a>根据生产环境安装操作系统（centos 7.1.1503 64位系统），安装完成后，使用Xshell通过ssh协议连接服务器。</h1><h2 id="ssh-用户名-IP-回车-输入密码后登录系统。"><a href="#ssh-用户名-IP-回车-输入密码后登录系统。" class="headerlink" title="ssh 用户名@IP+回车+输入密码后登录系统。"></a>ssh 用户名@IP+回车+输入密码后登录系统。</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$&amp;: mkdir -p /home/tools</div><div class="line">$&amp;: <span class="built_in">cd</span> /home/tools</div></pre></td></tr></table></figure>
<h2 id="将软件包上传到-home-tools"><a href="#将软件包上传到-home-tools" class="headerlink" title="将软件包上传到/home/tools"></a>将软件包上传到/home/tools</h2><h2 id="修改网卡的配置文件"><a href="#修改网卡的配置文件" class="headerlink" title="修改网卡的配置文件"></a>修改网卡的配置文件</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">$&amp;: vim /etc/sysconfig/network-scripts/ifcfg-ens32 //ifcfg-ens32是网卡的设备名称，每个机器的设备名不一样，修改的时候改成自己机器的设备名称</div><div class="line">HWADDR=00:1e:37:25:92:77 //改成自己机器的MAC地址</div><div class="line">TYPE=Ethernet</div><div class="line">BOOTPROTO=static</div><div class="line">DEFROUTE=yes</div><div class="line">PEERDNS=yes</div><div class="line">PEERROUTES=yes</div><div class="line">USERCTL=no</div><div class="line">NM_CONTROLLED=no</div><div class="line">IPV4_FAILURE_FATAL=no</div><div class="line">IPV6INIT=yes</div><div class="line">IPV6_AUTOCONF=yes</div><div class="line">IPV6_DEFROUTE=yes</div><div class="line">IPV6_PEERDNS=yes</div><div class="line">IPV6_PEERROUTES=yes</div><div class="line">IPV6_FAILURE_FATAL=no</div><div class="line">NAME=eno16777736</div><div class="line">ONBOOT=yes</div><div class="line">IPADDR=192.168.1.91</div><div class="line">NETMASK=255.255.255.0</div><div class="line">GATEWAY=192.168.1.1</div><div class="line">DNS1=202.106.0.20</div><div class="line">$&amp;: systemctl <span class="_">-f</span> restart NetworkManager</div></pre></td></tr></table></figure>
<h2 id="关键配置："><a href="#关键配置：" class="headerlink" title="关键配置："></a>关键配置：</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">TYPE=Ethernet</div><div class="line">BOOTPROTO=static</div><div class="line">NAME=eno16777736</div><div class="line">ONBOOT=yes</div><div class="line">IPADDR=192.168.117.128</div><div class="line">NETMASK=255.255.255.0</div><div class="line">GATEWAY=192.168.117.2</div><div class="line">DNS1=192.168.117.2</div><div class="line">$&amp;: cat /etc/resolv.conf</div><div class="line">nameserver 192.168.117.2</div></pre></td></tr></table></figure>
<h2 id="创建软件包存储目录"><a href="#创建软件包存储目录" class="headerlink" title="创建软件包存储目录"></a>创建软件包存储目录</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">$&amp;: <span class="built_in">cd</span> /home/</div><div class="line">$&amp;: mkdir tools</div><div class="line">$&amp;: <span class="built_in">cd</span> tools/</div></pre></td></tr></table></figure>
<h2 id="安装系统程序"><a href="#安装系统程序" class="headerlink" title="安装系统程序"></a>安装系统程序</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">$&amp;: yum -y install wget</div><div class="line">$&amp;: yum -y install vim*</div><div class="line">$&amp;: yum -y install ntpdate</div><div class="line">$&amp;: yum -y install mlocate</div><div class="line">$&amp;: updatedb</div><div class="line">$&amp;: yum -y install lrzsz* //可安装可不安装</div><div class="line">$&amp;: yum -y install openssl*</div><div class="line">$&amp;: yum -y install pcre-devel</div><div class="line">$&amp;: yum -y install ncurses-devel</div><div class="line">$&amp;: yum -y install gcc python-devel</div><div class="line">$&amp;: service iptables stop</div></pre></td></tr></table></figure>
<h2 id="centos-7-0执行如下内容"><a href="#centos-7-0执行如下内容" class="headerlink" title="centos 7.0执行如下内容"></a>centos 7.0执行如下内容</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">$&amp;: systemctl start firewalld.service //启动firewall</div><div class="line">$&amp;: systemctl stop firewalld.service //停止firewall</div><div class="line">$&amp;: systemctl <span class="built_in">disable</span> firewalld.service //禁止firewall开机启动</div><div class="line">$&amp;: chmod +x /etc/rc.d/rc.local //设置开机启动项脚本权限</div></pre></td></tr></table></figure>
<h2 id="时间同步"><a href="#时间同步" class="headerlink" title="时间同步"></a>时间同步</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$&amp;: /usr/sbin/ntpdate us.pool.ntp.org | logger -t NTP // 0-59/10 * * * * /usr/sbin/ntpdate us.pool.ntp.org | logger -t NTP(每隔10分钟同步一下时钟)</div></pre></td></tr></table></figure>
<h2 id="下载nginx、pcre、zlib"><a href="#下载nginx、pcre、zlib" class="headerlink" title="下载nginx、pcre、zlib"></a>下载nginx、pcre、zlib</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">$&amp;: wget http://nginx.org/download/nginx-1.8.0.tar.gz</div><div class="line">$&amp;: wget ftp://ftp.csx.cam.ac.uk/pub/software/programming/pcre/pcre2-10.00.tar.gz</div><div class="line">$&amp;: wget http://zlib.net/zlib-1.2.8.tar.gz</div></pre></td></tr></table></figure>
<h2 id="安装pcre"><a href="#安装pcre" class="headerlink" title="安装pcre"></a>安装pcre</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">$&amp;: tar -zxvf pcre2-10.00.tar.gz</div><div class="line">$&amp;: <span class="built_in">cd</span> pcre2-10.00/</div><div class="line">$&amp;: ./configure</div><div class="line">$&amp;: make</div><div class="line">$&amp;: make install</div><div class="line">$&amp;: <span class="built_in">cd</span> /home/tools/</div></pre></td></tr></table></figure>
<h2 id="安装zlib"><a href="#安装zlib" class="headerlink" title="安装zlib"></a>安装zlib</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">$&amp;: tar -zxvf zlib-1.2.8.tar.gz</div><div class="line">$&amp;: <span class="built_in">cd</span> zlib-1.2.8</div><div class="line">$&amp;: ./configure</div><div class="line">$&amp;: make</div><div class="line">$&amp;: make install</div></pre></td></tr></table></figure>
<h2 id="安装第三方软件源"><a href="#安装第三方软件源" class="headerlink" title="安装第三方软件源"></a>安装第三方软件源</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$&amp;: wget http://packages.sw.be/rpmforge-release/rpmforge-release-0.5.2-2.el5.rf.x86_64.rpm</div><div class="line">$&amp;: rpm -ivh rpmforge-release-0.5.2-2.el5.rf.x86_64.rpm</div></pre></td></tr></table></figure>
<h1 id="安装nginx"><a href="#安装nginx" class="headerlink" title="安装nginx"></a>安装nginx</h1><figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line">$&amp;: <span class="built_in">cd</span> /home/tools/</div><div class="line">$&amp;: tar -zxvf nginx-1.8.0.tar.gz</div><div class="line">$&amp;: <span class="built_in">cd</span> nginx-1.8.0/</div><div class="line">$&amp;: /usr/sbin/groupadd www</div><div class="line">$&amp;: /usr/sbin/useradd -g www www</div><div class="line">$&amp;: ./configure –user=www –group=www –with-http_stub_status_module –with-http_gzip_static_module –prefix=/usr/<span class="built_in">local</span>/nginx</div><div class="line">$&amp;: ./configure –user=www –group=www –with-http_stub_status_module –with-http_gzip_static_module –with-http_ssl_module –prefix=/usr/<span class="built_in">local</span>/nginx //支持https</div><div class="line">$&amp;: make</div><div class="line">$&amp;: make install</div><div class="line">$&amp;: mkdir -p /home/logs</div><div class="line">$&amp;: mkdir -p /home/logs/api.m.woniuanjia.com</div><div class="line">$&amp;: mkdir -p /home/logs/www.m.woniuanjia.com</div><div class="line">$&amp;: mkdir -p /home/logs/demo.woniuanjia.com</div><div class="line">$&amp;: mkdir -p /home/app/api.m.woniuanjia.com</div><div class="line">$&amp;: mkdir -p /home/app/www.m.woniuanjia.com</div><div class="line">$&amp;: mkdir -p /home/app/demo.woniuanjia.com</div><div class="line">$&amp;: mkdir /home/logs/nginx-log/</div><div class="line">$&amp;: chmod +w /home/logs</div><div class="line">$&amp;: chmod +w /home/app/api.m.woniuanjia.com/</div><div class="line">$&amp;: chmod +w /home/app/www.m.woniuanjia.com/</div><div class="line">$&amp;: chmod +w /home/app/demo.woniuanjia.com/</div><div class="line">$&amp;: chmod +w /home/logs/nginx-log/</div><div class="line">$&amp;: chown -R www:www /home/logs/</div><div class="line">$&amp;: chown -R www:www /home/app/</div><div class="line">$&amp;: chown -R www:www /home/logs/nginx-log/</div><div class="line">$&amp;: mkdir -p /home/nginx/logs/</div><div class="line">$&amp;: vim /etc/passwd</div><div class="line">www:x:500:500::/home/www:/sbin/nologin</div><div class="line">$&amp;: cp /usr/<span class="built_in">local</span>/nginx/conf/nginx.conf /usr/<span class="built_in">local</span>/nginx/conf/nginx.conf.bak</div><div class="line">$&amp;: cat /dev/null &gt;/usr/<span class="built_in">local</span>/nginx/conf/nginx.conf</div><div class="line">$&amp;: vim /usr/<span class="built_in">local</span>/nginx/conf/nginx.conf</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line">user www www;</div><div class="line">worker_processes 2;</div><div class="line">worker_cpu_affinity 0101 1010;</div><div class="line">error_log /home/logs/nginx-log/error.log crit;</div><div class="line">pid /usr/local/nginx/logs/nginx.pid;</div><div class="line">worker_rlimit_nofile 65535;</div><div class="line">events &#123;</div><div class="line">    use epoll;</div><div class="line">    worker_connections 65535;</div><div class="line">&#125;</div><div class="line">http &#123;</div><div class="line">    include mime.types;</div><div class="line">    default_type application/octet-stream;</div><div class="line">    charset utf-8;</div><div class="line">    log_format access ‘$remote_addr – $remote_user [$time_local] “$request” $status $body_bytes_sent “$http_referer” “$http_user_agent” “$http_x_forwarded_for” host’;</div><div class="line">    server_names_hash_bucket_size 128;</div><div class="line">    client_header_buffer_size 4k;</div><div class="line">    large_client_header_buffers 4 4k;</div><div class="line">    sendfile on;</div><div class="line">    tcp_nopush on;</div><div class="line">    tcp_nodelay on;</div><div class="line">    server_tokens off;</div><div class="line">    keepalive_timeout 60;</div><div class="line">    gzip on;</div><div class="line">    gzip_min_length 1k;</div><div class="line">    gzip_buffers 4 16k;</div><div class="line">    gzip_http_version 1.1;</div><div class="line">    gzip_comp_level 4;</div><div class="line">    $&amp;: gzip_types text/plain application/x-javascript text/css application/xml;</div><div class="line">    gzip_types text/plain application/x-javascript text/css;</div><div class="line">    gzip_vary on;</div><div class="line">    server &#123;</div><div class="line">        listen 80 default;</div><div class="line">        return 200;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>以上为默认增加的nginx配置</li>
<li>以下为项目在线host配置</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">$&amp;:  host.woniu.com #</div><div class="line"></div><div class="line">     server &#123;</div><div class="line">         listen 80;</div><div class="line">         server_name host.woniu.com 192.168.1.91;</div><div class="line">         root /home/app/host.woniu.com/;</div><div class="line">     &#125;</div></pre></td></tr></table></figure>
<ul>
<li>以下为新增的nginx配置</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$&amp;: api.m.woniuanjia.com#</div></pre></td></tr></table></figure>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line">server &#123;</div><div class="line">    listen 80;</div><div class="line">    server_name api.m.woniuanjia.com;</div><div class="line">    charset utf-8;</div><div class="line">    root /home/app/api.m.woniuanjia.com/v1.0/web/;</div><div class="line">    location / &#123;</div><div class="line">        index index.php index.html index.htm;</div><div class="line">    &#125;</div><div class="line">    location /v1.0/ &#123;</div><div class="line">        index index.php;</div><div class="line">        alias /home/app/api.m.woniuanjia.com/v1.0/web/;</div><div class="line">    &#125;</div><div class="line">    error_page 500 502 503 504 /50x.html;</div><div class="line">    location = /50x.html &#123;</div><div class="line">        root html;</div><div class="line">    &#125;</div><div class="line">    location ~ ^/v1.0/(.*\.php)$ &#123;</div><div class="line">        fastcgi_pass 127.0.0.1:9000;</div><div class="line">        fastcgi_index index.php;</div><div class="line">        fastcgi_param SCRIPT_FILENAME /home/app/api.m.woniuanjia.com/v1.0/web/$1;</div><div class="line">        include fastcgi_params;</div><div class="line">    &#125;</div><div class="line">    location ~ \.php$ &#123;</div><div class="line">        fastcgi_pass 127.0.0.1:9000;</div><div class="line">        fastcgi_index index.php;</div><div class="line">        fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;</div><div class="line">        include fastcgi_params;</div><div class="line">    &#125;</div><div class="line">    access_log /home/logs/api.m.woniuanjia.com/access.log access;</div><div class="line">    error_log /home/logs/api.m.woniuanjia.com/error.log info;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$&amp;: www.m.woniuanjia.com<span class="comment">#</span></div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line">server &#123;</div><div class="line">    listen 80;</div><div class="line">    server_name www.m.woniuanjia.com;</div><div class="line">    charset utf-8;</div><div class="line">    root /home/app/www.m.woniuanjia.com/v1.0/;</div><div class="line">    location / &#123;</div><div class="line">        index index.php index.html index.htm;</div><div class="line">    &#125;</div><div class="line">    location /v1.0/ &#123;</div><div class="line">        index index.php;</div><div class="line">        alias /home/app/www.m.woniuanjia.com/v1.0/;</div><div class="line">    &#125;</div><div class="line">    error_page 500 502 503 504 /50x.html;</div><div class="line">    location = /50x.html &#123;</div><div class="line">        root html;</div><div class="line">    &#125;</div><div class="line">    location ~ ^/v1.0/(.*\.php)$ &#123;</div><div class="line">        fastcgi_pass 127.0.0.1:9000;</div><div class="line">        fastcgi_index index.php;</div><div class="line">        fastcgi_param SCRIPT_FILENAME /home/app/www.m.woniuanjia.com/v1.0/$1;</div><div class="line">        include fastcgi_params;</div><div class="line">    &#125;</div><div class="line">    location ~ \.php$ &#123;</div><div class="line">        fastcgi_pass 127.0.0.1:9000;</div><div class="line">        fastcgi_index index.php;</div><div class="line">        fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;</div><div class="line">        include fastcgi_params;</div><div class="line">    &#125;</div><div class="line">    access_log /home/logs/www.m.woniuanjia.com/access.log access;</div><div class="line">    error_log /home/logs/www.m.woniuanjia.com/error.log info;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$&amp;: demo.woniuanjia.com<span class="comment">#</span></div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">server &#123;</div><div class="line">    listen 80;</div><div class="line">    server_name demo.woniuanjia.com;</div><div class="line">    root /home/app/demo.woniuanjia.com/v1.0/;</div><div class="line">    location / &#123;</div><div class="line">            index index.php index.html index.htm;</div><div class="line">            if (!-e $request_filename) &#123;</div><div class="line">                rewrite ^/(.*)$ /index.php?$1 last;</div><div class="line">                break;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    location ~ \.php$ &#123;</div><div class="line">        fastcgi_pass 127.0.0.1:9000;</div><div class="line">        fastcgi_index index.php;</div><div class="line">        fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;</div><div class="line">        include fastcgi_params;</div><div class="line">    &#125;</div><div class="line">    access_log /home/logs/demo.woniuanjia.com/access.log access;</div><div class="line">    error_log /home/logs/demo.woniuanjia.com/error.log info;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$&amp;: img.woniuanjia.com<span class="comment">#</span></div></pre></td></tr></table></figure>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">server &#123;</div><div class="line">    listen 80;</div><div class="line">    server_name img.m.woniuanjia.com;</div><div class="line">    root /home/app/img.m.woniuanjia.com/;</div><div class="line">    location / &#123;</div><div class="line">        index index.php index.html index.htm;</div><div class="line">            <span class="keyword">if</span> (!<span class="_">-e</span> <span class="variable">$request_filename</span>) &#123;</div><div class="line">            rewrite ^/(.*)$ /index.php?<span class="variable">$1</span> last;</div><div class="line">            <span class="built_in">break</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">$&amp;: finish</div><div class="line"></div><div class="line"> $&amp;: vim /etc/security/limits.conf</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">*              soft    nproc   16384</div><div class="line">*              hard    nproc   16384</div><div class="line">*              soft    nofile  4096</div><div class="line">*              hard    nofile  65536</div><div class="line">*              soft    stack   10240</div></pre></td></tr></table></figure>
<ul>
<li>修改完之后退出重新登录生效</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">$&amp;: <span class="built_in">ulimit</span> -n</div><div class="line">$&amp;: <span class="built_in">ulimit</span> <span class="_">-a</span></div><div class="line">$&amp;: mkdir /home/crontab</div><div class="line">$&amp;: vim /home/crontab/cut_nginx_log.sh</div><div class="line">$&amp;: !/bin/bash</div><div class="line">$&amp;: auth peter</div><div class="line">$&amp;:  定时切割Nginx日志的脚本</div><div class="line">$&amp;:  每小时生产一份日志</div><div class="line">$&amp;:  如果是每月1号,则将上月日志归档</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">today=`date +%e`</div><div class="line">monthlog=`date -d ‘-1 month’ +%Y%m`</div><div class="line">hour=`date +%k`</div><div class="line">hour_accesslogname=`date +”%Y%m%d%H” –date=”-1 hour”`</div><div class="line">day_errorlogname=`date +”%Y%m%d” –date=”-1 day”`</div></pre></td></tr></table></figure>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div></pre></td><td class="code"><pre><div class="line">$&amp;:  The Nginx logs path</div><div class="line">    $&amp;: 切割api.m.woniuanjia.com日志</div><div class="line">        logs_path=”/home/logs/api.m.woniuanjia.com/”</div><div class="line">        mv <span class="variable">$&#123;logs_path&#125;</span>access.log <span class="variable">$&#123;logs_path&#125;</span>access-<span class="variable">$&#123;hour_accesslogname&#125;</span>.log</div><div class="line">        <span class="keyword">if</span> [ <span class="variable">$hour</span> <span class="_">-eq</span> 0 ]; <span class="keyword">then</span></div><div class="line">        mv <span class="variable">$&#123;logs_path&#125;</span>error.log <span class="variable">$&#123;logs_path&#125;</span>error-<span class="variable">$&#123;day_errorlogname&#125;</span>.log</div><div class="line">        <span class="keyword">fi</span></div><div class="line">        <span class="keyword">if</span> [ <span class="variable">$today</span> <span class="_">-eq</span> 1 ]; <span class="keyword">then</span></div><div class="line">        <span class="keyword">if</span> [ ! <span class="_">-e</span> <span class="variable">$&#123;logs_path&#125;</span><span class="variable">$&#123;monthlog&#125;</span> ]; <span class="keyword">then</span></div><div class="line">        mkdir <span class="variable">$&#123;logs_path&#125;</span><span class="variable">$&#123;monthlog&#125;</span></div><div class="line">        <span class="keyword">fi</span></div><div class="line">        mv <span class="variable">$&#123;logs_path&#125;</span>access-<span class="variable">$&#123;monthlog&#125;</span>*.log <span class="variable">$&#123;logs_path&#125;</span><span class="variable">$&#123;monthlog&#125;</span></div><div class="line">        mv <span class="variable">$&#123;logs_path&#125;</span>error-<span class="variable">$&#123;monthlog&#125;</span>*.log <span class="variable">$&#123;logs_path&#125;</span><span class="variable">$&#123;monthlog&#125;</span></div><div class="line">        <span class="keyword">fi</span></div><div class="line">    $&amp;: 切割www.m.woniuanjia.com日志</div><div class="line">        logs_path=”/home/logs/www.m.woniuanjia.com/”</div><div class="line">        mv <span class="variable">$&#123;logs_path&#125;</span>access.log <span class="variable">$&#123;logs_path&#125;</span>access-<span class="variable">$&#123;hour_accesslogname&#125;</span>.log</div><div class="line">        <span class="keyword">if</span> [ <span class="variable">$hour</span> <span class="_">-eq</span> 0 ]; <span class="keyword">then</span></div><div class="line">        mv <span class="variable">$&#123;logs_path&#125;</span>error.log <span class="variable">$&#123;logs_path&#125;</span>error-<span class="variable">$&#123;day_errorlogname&#125;</span>.log</div><div class="line">        <span class="keyword">fi</span></div><div class="line">        <span class="keyword">if</span> [ <span class="variable">$today</span> <span class="_">-eq</span> 1 ]; <span class="keyword">then</span></div><div class="line">        <span class="keyword">if</span> [ ! <span class="_">-e</span> <span class="variable">$&#123;logs_path&#125;</span><span class="variable">$&#123;monthlog&#125;</span> ]; <span class="keyword">then</span></div><div class="line">        mkdir <span class="variable">$&#123;logs_path&#125;</span><span class="variable">$&#123;monthlog&#125;</span></div><div class="line">        <span class="keyword">fi</span></div><div class="line">        mv <span class="variable">$&#123;logs_path&#125;</span>access-<span class="variable">$&#123;monthlog&#125;</span>*.log <span class="variable">$&#123;logs_path&#125;</span><span class="variable">$&#123;monthlog&#125;</span></div><div class="line">        mv <span class="variable">$&#123;logs_path&#125;</span>error-<span class="variable">$&#123;monthlog&#125;</span>*.log <span class="variable">$&#123;logs_path&#125;</span><span class="variable">$&#123;monthlog&#125;</span></div><div class="line">        <span class="keyword">fi</span></div><div class="line">    $&amp;: 切割demo.woniuanjia.com日志</div><div class="line">        logs_path=”/home/logs/demo.woniuanjia.com/”</div><div class="line">        mv <span class="variable">$&#123;logs_path&#125;</span>access.log <span class="variable">$&#123;logs_path&#125;</span>access-<span class="variable">$&#123;hour_accesslogname&#125;</span>.log</div><div class="line">        <span class="keyword">if</span> [ <span class="variable">$hour</span> <span class="_">-eq</span> 0 ]; <span class="keyword">then</span></div><div class="line">        mv <span class="variable">$&#123;logs_path&#125;</span>error.log <span class="variable">$&#123;logs_path&#125;</span>error-<span class="variable">$&#123;day_errorlogname&#125;</span>.log</div><div class="line">        <span class="keyword">fi</span></div><div class="line">        <span class="keyword">if</span> [ <span class="variable">$today</span> <span class="_">-eq</span> 1 ]; <span class="keyword">then</span></div><div class="line">        <span class="keyword">if</span> [ ! <span class="_">-e</span> <span class="variable">$&#123;logs_path&#125;</span><span class="variable">$&#123;monthlog&#125;</span> ]; <span class="keyword">then</span></div><div class="line">        mkdir <span class="variable">$&#123;logs_path&#125;</span><span class="variable">$&#123;monthlog&#125;</span></div><div class="line">        <span class="keyword">fi</span></div><div class="line">        mv <span class="variable">$&#123;logs_path&#125;</span>access-<span class="variable">$&#123;monthlog&#125;</span>*.log <span class="variable">$&#123;logs_path&#125;</span><span class="variable">$&#123;monthlog&#125;</span></div><div class="line">        mv <span class="variable">$&#123;logs_path&#125;</span>error-<span class="variable">$&#123;monthlog&#125;</span>*.log <span class="variable">$&#123;logs_path&#125;</span><span class="variable">$&#123;monthlog&#125;</span></div><div class="line">        <span class="keyword">fi</span></div><div class="line">        <span class="built_in">kill</span> -USR1 `cat /usr/<span class="built_in">local</span>/nginx/logs/nginx.pid`</div><div class="line">        $&amp;: chmod +x /home/crontab/cut_nginx_log.sh</div><div class="line">        $&amp;: chown www:www /home/crontab/cut_nginx_log.sh</div><div class="line">        $&amp;: crontab <span class="_">-e</span></div><div class="line">        00 10 * * * /bin/bash /home/crontab/cut_nginx_log.sh</div><div class="line">$&amp;: vim /etc/rc.d/rc.local</div><div class="line">/usr/<span class="built_in">local</span>/nginx/sbin/nginx</div><div class="line">$&amp;: /usr/<span class="built_in">local</span>/nginx/sbin/nginx -t</div><div class="line">$&amp;: /usr/<span class="built_in">local</span>/nginx/sbin/nginx</div><div class="line">$&amp;: /usr/<span class="built_in">local</span>/nginx/sbin/nginx <span class="_">-s</span> reload</div></pre></td></tr></table></figure>
<h2 id="安装mysql"><a href="#安装mysql" class="headerlink" title="安装mysql"></a>安装mysql</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line">$&amp;: <span class="built_in">cd</span> /home/tools/</div><div class="line">$&amp;: wget http://dev.mysql.com/get/Downloads/MySQL-5.6/mysql-5.6.15.tar.gz</div><div class="line">$&amp;: wget http://www.cmake.org/files/v2.8/cmake-2.8.4.tar.gz</div><div class="line">$&amp;: wget http://ftp.gnu.org/gnu/bison/bison-3.0.4.tar.gz</div><div class="line">$&amp;: tar zxvf cmake-2.8.4.tar.gz</div><div class="line">$&amp;: <span class="built_in">cd</span> cmake-2.8.4</div><div class="line">$&amp;: ./bootstrap</div><div class="line">$&amp;: gmake</div><div class="line">$&amp;: gmake install</div><div class="line">$&amp;: <span class="built_in">cd</span> ..</div><div class="line">$&amp;: tar zxvf bison-3.0.4.tar.gz</div><div class="line">$&amp;: <span class="built_in">cd</span> bison-3.0.4/</div><div class="line">$&amp;: ./configure</div><div class="line">$&amp;: make</div><div class="line">$&amp;: make install</div><div class="line">$&amp;: <span class="built_in">cd</span> ..</div><div class="line">$&amp;: /usr/sbin/groupadd mysql</div><div class="line">$&amp;: /usr/sbin/useradd -g mysql mysql</div><div class="line">$&amp;: vim /etc/passwd</div><div class="line">mysql:x:501:501::/home/mysql:/sbin/nologin</div><div class="line">$&amp;: tar -zxvf mysql-5.6.24.tar.gz</div><div class="line">$&amp;: <span class="built_in">cd</span> mysql-5.6.24</div><div class="line">$&amp;: cmake -DCMAKE_INSTALL_PREFIX=/usr/<span class="built_in">local</span>/mysql \</div><div class="line">    -DMYSQL_UNIX_ADDR=/usr/<span class="built_in">local</span>/mysql/mysql.sock \</div><div class="line">    -DDEFAULT_CHARSET=utf8 \</div><div class="line">    -DDEFAULT_COLLATION=utf8_general_ci \</div><div class="line">    -DWITH_EXTRA_CHARSETS:STRING=utf8,gbk \</div><div class="line">    -DWITH_MYISAM_STORAGE_ENGINE=1 \</div><div class="line">    -DWITH_INNOBASE_STORAGE_ENGINE=1 \</div><div class="line">    -DENABLED_LOCAL_INFILE=1 \</div><div class="line">    -DMYSQL_DATADIR=/usr/<span class="built_in">local</span>/mysql/data</div></pre></td></tr></table></figure>
<p>   PS:<br>   以上参数等说明:<br> <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">```  </div><div class="line">       DCMAKE_INSTALL_PREFIX=/usr/local/mysql #mysql安装的主目录，默认为/usr/local/mysql</div><div class="line">       DMYSQL_DATADIR=/usr/local/mysql/data #mysql数据库文件的存放目录，可以自定义</div><div class="line">       DMYSQL_UNIX_ADDR=/usr/local/mysql/mysql.sock #系统Socket文件（.sock）设置,基于该文件路径进行Socket链接，必须为绝对路径</div><div class="line">       DSYSCONFDIR=/etc #mysql配置文件 my.cnf的存放地址，默认为/etc下</div><div class="line">       DMYSQL_TCP_PORT=3306 #数据库服务器监听端口，默认为3306</div><div class="line">       DENABLED_LOCAL_INFILE=1 #允许从本地导入数据</div><div class="line">       DWITH_READLINE=1 #快捷键功能</div><div class="line">       DWITH_SSL=yes #支持 SSL</div><div class="line">       DMYSQL_USER=mysql #默认为mysql</div><div class="line">   //下面3个是数据库编码设置</div><div class="line">   </div><div class="line">       DEXTRA_CHARSETS=all #安装所有扩展字符集，默认为all</div><div class="line">       DDEFAULT_CHARSET=utf8 #使用 utf8 字符</div><div class="line">       DDEFAULT_COLLATION=utf8_general_ci #校验字符</div><div class="line">   //下面5个是数据库存储引擎设在</div><div class="line">   </div><div class="line">       DWITH_MYISAM_STORAGE_ENGINE=1 #安装 myisam 存储引擎</div><div class="line">       DWITH_INNOBASE_STORAGE_ENGINE=1 #安装 innodb 存储引擎</div><div class="line">       DWITH_ARCHIVE_STORAGE_ENGINE=1 #安装 archive 存储引擎</div><div class="line">       DWITH_BLACKHOLE_STORAGE_ENGINE=1 #安装 blackhole 存储引擎</div><div class="line">       DWITH_PARTITION_STORAGE_ENGINE=1 #安装数据库分区</div></pre></td></tr></table></figure></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$&amp;: make</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">---- 可能报错</div><div class="line"></div><div class="line">          FATAL ERROR: Could not find ./bin/my_print_defaults</div><div class="line">          If you compiled from source, you need to run &apos;make install&apos; to</div><div class="line">          copy the software into the correct location ready for operation.</div><div class="line">          If you are using a binary release, you must either be at the top</div><div class="line">          level of the extracted archive, or pass the --basedir option</div><div class="line">          pointing to that location.</div><div class="line"></div><div class="line">---- 解决方案</div></pre></td></tr></table></figure>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="comment">#/usr/local/bin/mysql_install_db --user=mysql --basedir=/usr/local/ --datadir=/var/db/mysql &amp;</span></div><div class="line">$&amp;: make install</div><div class="line">$&amp;: chmod +w /usr/<span class="built_in">local</span>/mysql</div><div class="line">$&amp;: chown -R mysql:mysql /usr/<span class="built_in">local</span>/mysql <span class="comment">#改变目录拥有者与所属组</span></div><div class="line">$&amp;: ln <span class="_">-s</span> /usr/<span class="built_in">local</span>/mysql/lib/libmysqlclient.so.16 /usr/lib/libmysqlclient.so.16</div><div class="line">$&amp;: ln <span class="_">-s</span> /usr/<span class="built_in">local</span>/mysql/lib/libmysqlclient.so.16 /usr/lib64/libmysqlclient.so.16</div><div class="line">$&amp;: <span class="built_in">cd</span> support-files/</div><div class="line">$&amp;: cp my-default.cnf /etc/my.cnf <span class="comment">#选择默认配置文件 适合大型服务器</span></div><div class="line">cp：是否覆盖”/etc/my.cnf”？ y</div><div class="line">$&amp;: cp mysql.server /etc/init.d/mysqld <span class="comment">#复制启动文件</span></div><div class="line">$&amp;: vim /etc/my.cnf</div></pre></td></tr></table></figure>
<p>在[mysqld]下面添加</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div></pre></td><td class="code"><pre><div class="line">basedir = /usr/<span class="built_in">local</span>/mysql/</div><div class="line">datadir = /usr/<span class="built_in">local</span>/mysql/data</div><div class="line"><span class="built_in">log</span>-error = /usr/<span class="built_in">local</span>/mysql/mysql_error.log</div><div class="line">pid-file = /usr/<span class="built_in">local</span>/mysql/data/mysql.pid</div><div class="line">default-storage-engine=INNODB</div><div class="line">user = mysql</div><div class="line">$&amp;: /usr/<span class="built_in">local</span>/mysql/scripts/mysql_install_db \</div><div class="line">–basedir=/usr/<span class="built_in">local</span>/mysql \</div><div class="line">–datadir=/usr/<span class="built_in">local</span>/mysql/data \</div><div class="line">–user=mysql</div><div class="line">$&amp;: chmod +x /etc/init.d/mysqld</div><div class="line">$&amp;: vim /etc/init.d/mysqld（编辑此文件，查找并修改以下变量内容：）</div><div class="line">basedir=/usr/<span class="built_in">local</span>/mysql</div><div class="line">datadir=/usr/<span class="built_in">local</span>/mysql/data</div><div class="line">$&amp;: chkconfig –add mysqld</div><div class="line">$&amp;: chkconfig –level 345 mysqld on</div><div class="line">$&amp;: <span class="built_in">export</span> PATH=/usr/<span class="built_in">local</span>/mysql/bin:<span class="variable">$PATH</span> //为MySQL配置环境变量，以后使用起来方便</div><div class="line">$&amp;: service mysqld start</div><div class="line">Starting MySQL. SUCCESS!</div><div class="line">$&amp;: mysql_secure_installation</div><div class="line">NOTE: RUNNING ALL PARTS OF THIS SCRIPT IS RECOMMENDED FOR ALL MySQL</div><div class="line">SERVERS IN PRODUCTION USE! PLEASE READ EACH STEP CAREFULLY!</div><div class="line">In order to <span class="built_in">log</span> into MySQL to secure it, we’ll need the current</div><div class="line">password <span class="keyword">for</span> the root user. If you’ve just installed MySQL, and</div><div class="line">you haven’t <span class="built_in">set</span> the root password yet, the password will be blank,</div><div class="line">so you should just press enter here.</div><div class="line">Enter current password <span class="keyword">for</span> root (enter <span class="keyword">for</span> none): 输入mysql的root密码，默认为空</div><div class="line">OK, successfully used password, moving on…</div><div class="line">Setting the root password ensures that nobody can <span class="built_in">log</span> into the MySQL</div><div class="line">root user without the proper authorisation.</div><div class="line">You already have a root password <span class="built_in">set</span>, so you can safely answer ‘n’.</div><div class="line">Change the root password? [Y/n] y //是否修改mysql的密码，选择y</div><div class="line">New password: 输入mysql的密码</div><div class="line">Re-enter new password: 重复输入mysql的密码</div><div class="line">Password updated successfully!//密码修改成功</div><div class="line">Reloading privilege tables..</div><div class="line">… Success!</div><div class="line">By default, a MySQL installation has an anonymous user, allowing anyone</div><div class="line">to <span class="built_in">log</span> into MySQL without having to have a user account created <span class="keyword">for</span></div><div class="line">them. This is intended only <span class="keyword">for</span> testing, and to make the installation</div><div class="line">go a bit smoother. You should remove them before moving into a</div><div class="line">production environment.</div><div class="line">Remove anonymous users? [Y/n] y //删除匿名用户</div><div class="line">… Success!</div><div class="line">Normally, root should only be allowed to connect from ‘localhost’. This</div><div class="line">ensures that someone cannot guess at the root password from the network.</div><div class="line">Disallow root login remotely? [Y/n] y //禁止root远程登录</div><div class="line">… skipping.</div><div class="line">By default, MySQL comes with a database named ‘<span class="built_in">test</span>’ that anyone can</div><div class="line">access. This is also intended only <span class="keyword">for</span> testing, and should be removed</div><div class="line">before moving into a production environment.</div><div class="line">Remove <span class="built_in">test</span> database and access to it? [Y/n] y //删除测试数据库和访问它</div><div class="line">– Dropping <span class="built_in">test</span> database…</div><div class="line">ERROR 1010 (HY000) at line 1: Error dropping database (can’t rmdir ‘./<span class="built_in">test</span>/’, errno: 17)</div><div class="line">… Failed! Not critical, keep moving…</div><div class="line">– Removing privileges on <span class="built_in">test</span> database…</div><div class="line">… Success!</div><div class="line">Reloading the privilege tables will ensure that all changes made so far</div><div class="line">will take effect immediately.</div><div class="line">Reload privilege tables now? [Y/n] y //现在重载授权表</div><div class="line">… Success!</div><div class="line">Cleaning up…</div><div class="line">All <span class="keyword">done</span>! If you’ve completed all of the above steps, your MySQL</div><div class="line">installation should now be secure.</div><div class="line"></div><div class="line">Thanks <span class="keyword">for</span> using MySQL</div></pre></td></tr></table></figure>
<p>修改mysql密码—–SET PASSWORD FOR ‘root’@’localhost’ = PASSWORD(‘root123’);<br>查看及修改mysql最大连接数</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line">    $&amp;: ps -axef | grep mysqld –c</div><div class="line">    mysql&gt; show engines; //看你的mysql现在已提供什么存储引擎:</div><div class="line">    +——————–+———+—————————————————————-+————–+——+————+</div><div class="line">    | Engine | Support | Comment | Transactions | XA | Savepoints |</div><div class="line">    +——————–+———+—————————————————————-+————–+——+————+</div><div class="line">    | MyISAM | YES | MyISAM storage engine | NO | NO | NO |</div><div class="line">    | CSV | YES | CSV storage engine | NO | NO | NO |</div><div class="line">    | MRG_MYISAM | YES | Collection of identical MyISAM tables | NO | NO | NO |</div><div class="line">    | BLACKHOLE | YES | /dev/null storage engine (anything you write to it disappears) | NO | NO | NO |</div><div class="line">    | MEMORY | YES | Hash based, stored <span class="keyword">in</span> memory, useful <span class="keyword">for</span> temporary tables | NO | NO | NO |</div><div class="line">    | FEDERATED | NO | Federated MySQL storage engine | NULL | NULL | NULL |</div><div class="line">    | ARCHIVE | YES | Archive storage engine | NO | NO | NO |</div><div class="line">    | PERFORMANCE_SCHEMA | YES | Performance Schema | NO | NO | NO |</div><div class="line">    | InnoDB | DEFAULT | Supports transactions, row-level locking, and foreign keys | YES | YES | YES |</div><div class="line">    +——————–+———+—————————————————————-+————–+——+————+</div><div class="line">    9 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</div><div class="line">    mysql&gt; show variables like ‘%storage_engine%’;//看你的mysql当前默认的存储引擎:</div><div class="line">    +—————————-+——–+</div><div class="line">    | Variable_name | Value |</div><div class="line">    +—————————-+——–+</div><div class="line">    | default_storage_engine | InnoDB |</div><div class="line">    | default_tmp_storage_engine | InnoDB |</div><div class="line">    | storage_engine | InnoDB |</div><div class="line">    +—————————-+——–+</div><div class="line">3 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</div></pre></td></tr></table></figure>
<p>你要看某个表用了什么引擎(在显示结果里参数engine后面的就表示该表当前用的存储引擎):</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">mysql&gt; show create table 表名;</div><div class="line"> </div><div class="line">Mysql&gt;show variables like ‘max_connections’;</div><div class="line">Mysql&gt; <span class="built_in">set</span> GLOBAL max_connections=2000;</div><div class="line">Mysql&gt; show variables like ‘max_connections’;</div><div class="line">Mysql&gt; show processlist;//查看mysql的数据库连接</div><div class="line">$&amp;: Vim /etc/my.cnf //在mysqld中增加如下内容：</div><div class="line">max_connections=500</div><div class="line">back_<span class="built_in">log</span>=100</div><div class="line">$&amp;: mkdir -p /var/lib/mysql</div><div class="line">$&amp;: ln <span class="_">-s</span> /usr/<span class="built_in">local</span>/mysql/mysql.sock /var/lib/mysql/mysql.sock</div></pre></td></tr></table></figure>
<h1 id="安装php"><a href="#安装php" class="headerlink" title="安装php"></a>安装php</h1><figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">$&amp;: <span class="built_in">cd</span> /home/tools/</div><div class="line">$&amp;: tar -zxvf php-5.6.8.tar.gz</div><div class="line">$&amp;: yum -y install gd curl curl-devel libjpeg libjpeg-devel libpng libpng-devel freetype freetype-devel libxml2 libxml2-devel mysql mysql-devel</div><div class="line">$&amp;: <span class="built_in">cd</span> php-5.6.8</div><div class="line">$&amp;: ./configure –prefix=/usr/<span class="built_in">local</span>/php –<span class="built_in">enable</span>-fpm –<span class="built_in">enable</span>-debug –with-gd –with-jpeg-dir –with-png-dir –with-freetype-dir –<span class="built_in">enable</span>-mbstring –with-curl –with-mysql=/usr/<span class="built_in">local</span>/mysql/ –with-mysqli=/usr/<span class="built_in">local</span>/mysql/bin/mysql_config</div><div class="line">$&amp;: ./configure –prefix=/usr/<span class="built_in">local</span>/php –<span class="built_in">enable</span>-fpm –<span class="built_in">disable</span>-debug –with-gd –with-jpeg-dir –with-png-dir –with-freetype-dir –<span class="built_in">enable</span>-mbstring –with-curl –with-mysql=/usr/<span class="built_in">local</span>/mysql/ –with-mysqli=/usr/<span class="built_in">local</span>/mysql/bin/mysql_config</div></pre></td></tr></table></figure>
<p>   只有在开发php扩展库的时候需要开启–enable-debug，生产环境不需要，否则会影响性能。开发人员无法安装zend debug。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">$&amp;: make</div><div class="line">$&amp;: make install</div><div class="line">$&amp;: cp php.ini-development /usr/<span class="built_in">local</span>/php/lib/php.ini</div><div class="line">$&amp;: cp /usr/<span class="built_in">local</span>/php/etc/php-fpm.conf.default /usr/<span class="built_in">local</span>/php/etc/php-fpm.conf</div><div class="line">$&amp;: vim /usr/<span class="built_in">local</span>/php/lib/php.ini</div><div class="line">修改927行，修改之后如下：date.timezone = Asia/Chongqing</div><div class="line">$&amp;: vim /usr/<span class="built_in">local</span>/php/etc/php-fpm.conf</div><div class="line">修改;pid = run/php-fpm.pid 为pid = run/php-fpm.pid</div><div class="line">$&amp;: /usr/<span class="built_in">local</span>/php/sbin/php-fpm</div><div class="line">验证php和nginx的安装</div><div class="line">$&amp;: <span class="built_in">cd</span> /home/app/api.m.woniuanjia.com/v1.0/web</div><div class="line">$&amp;: vim a.php</div></pre></td></tr></table></figure>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line">phpinfo();</div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure>
<p>在浏览器中输入 <a href="http://api.m.woniuanjia.com/a.php" target="_blank" rel="external">http://api.m.woniuanjia.com/a.php</a><br>看到PHPinfo页面，解析PHP正常</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">$&amp;: ps aux | grep -c php-fpm //查看php-fpm进程数</div><div class="line">$&amp;: /usr/bin/php -i|grep mem //查看运行内存</div><div class="line">$&amp;: /etc/init.d/php-fpm restart //重启php-fpm</div><div class="line">$&amp;: vim /usr/<span class="built_in">local</span>/php/etc/php-fpm.conf</div><div class="line">pid = run/php-fpm.pid //把注释去掉</div><div class="line">$&amp;: /usr/<span class="built_in">local</span>/php/sbin/php-fpm //php-fpm 启动php-fpm</div><div class="line">$&amp;: <span class="built_in">kill</span> -INT `cat /usr/<span class="built_in">local</span>/php/var/run/php-fpm.pid` //关闭php-fpm</div><div class="line">$&amp;: <span class="built_in">kill</span> -USR2 `cat /usr/<span class="built_in">local</span>/php/var/run/php-fpm.pid` //重启php-fpm</div><div class="line">$&amp;: ps aux | grep -c php-fpm //查看php-fpm进程数</div></pre></td></tr></table></figure>
<h1 id="安装redis"><a href="#安装redis" class="headerlink" title="安装redis"></a>安装redis</h1><figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">$&amp;: <span class="built_in">cd</span> /home/tools/</div><div class="line">$&amp;: wget http://download.redis.io/releases/redis-3.0.1.tar.gz</div><div class="line">$&amp;: tar -zxvf redis-3.0.1.tar.gz</div><div class="line">$&amp;: <span class="built_in">cd</span> redis-3.0.1/</div><div class="line">$&amp;: make</div><div class="line">make命令执行完成后，会在当前src目录下生成本个可执行文件，分别是redis-server、redis-cli、redis-benchmark、redis-stat，它们的作用如下：</div><div class="line">redis-server：Redis服务器的daemon启动程序</div><div class="line">redis-cli：Redis命令行操作工具。当然，你也可以用telnet根据其纯文本协议来操作</div><div class="line">redis-benchmark：Redis性能测试工具，测试Redis在你的系统及你的配置下的读写性能</div><div class="line">redis-stat：Redis状态检测工具，可以检测Redis当前状态参数及延迟状况。</div><div class="line">$&amp;: cp redis.conf /etc/ //这个文件是redis启动的配置文件</div><div class="line">$&amp;: <span class="built_in">cd</span> src/</div><div class="line">$&amp;: cp redis-benchmark redis-cli redis-server /usr/bin/ //这个倒是很有用，这样就不用再执行时加上./了，而且可以在任何地方执行</div><div class="line">$&amp;: redis-server /etc/redis.conf //启动redis</div><div class="line">$&amp;: vim /etc/redis.conf</div></pre></td></tr></table></figure>
<p>   将daemonize no修改为daemonize yes<br>   保存退出<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">$&amp;: nohup redis-server /etc/redis.conf</div><div class="line">$&amp;: redis-cli shutdown //关闭redis服务</div></pre></td></tr></table></figure></p>
<pre><code>redis服务关闭后，缓存数据会自动dump到硬盘上，硬盘地址为redis.conf中的配置项dbfilename dump.rdb所设定
$&amp;: redis-cli save 或者 redis-cli -p 6380 save（指定端口） //强制备份数据到磁盘，使用如下命令
</code></pre><h1 id="安装redis-so模块"><a href="#安装redis-so模块" class="headerlink" title="安装redis.so模块"></a>安装redis.so模块</h1><figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">$&amp;: <span class="built_in">cd</span> /home/tools/</div><div class="line">$&amp;: wget https://github.com/nicolasff/phpredis/archive/master.zip</div><div class="line">$&amp;: unzip master.zip</div><div class="line">$&amp;: <span class="built_in">cd</span> phpredis-master/</div><div class="line">$&amp;: /usr/<span class="built_in">local</span>/php/bin/phpize</div><div class="line">$&amp;: ./configure –with-php-config=/usr/<span class="built_in">local</span>/php/bin/php-config</div><div class="line">$&amp;: make</div><div class="line">$&amp;: make install</div><div class="line">Installing shared extensions: /usr/<span class="built_in">local</span>/php/lib/php/extensions/debug-non-zts-20131226/</div></pre></td></tr></table></figure>
<pre><code>注意redis.so的全路径是：
/usr/local/php/lib/php/extensions/debug-non-zts-20131226/redis.so
$&amp;: vim /usr/local/php/lib/php.ini
</code></pre><p>   手工修改：查找/usr/local/php/lib/php.ini中的extension_dir = “./“<br>   修改为extension_dir = “/usr/local/php/lib/php/extensions/debug-non-zts-20131226/“<br>   并在此行后增加以下几行，然后保存：</p>
<pre><code>extension = &quot;redis.so&quot;
</code></pre><h1 id="安装PDO-mysql"><a href="#安装PDO-mysql" class="headerlink" title="安装PDO-mysql"></a>安装PDO-mysql</h1><figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">$&amp;: <span class="built_in">cd</span> /home/tools/</div><div class="line">$&amp;: wget http://pecl.php.net/get/PDO_MYSQL-1.0.2.tgz</div><div class="line">$&amp;: tar zxvf PDO_MYSQL-1.0.2.tgz</div><div class="line">package2.xml</div><div class="line">PDO_MYSQL-1.0.2/config.m4</div><div class="line">PDO_MYSQL-1.0.2/CREDITS</div><div class="line">PDO_MYSQL-1.0.2/mysql_driver.c</div><div class="line">PDO_MYSQL-1.0.2/mysql_statement.c</div><div class="line">PDO_MYSQL-1.0.2/pdo_mysql.c</div><div class="line">PDO_MYSQL-1.0.2/php_pdo_mysql.h</div><div class="line">PDO_MYSQL-1.0.2/php_pdo_mysql_int.h</div><div class="line">PDO_MYSQL-1.0.2/php_pdo_mysql_sqlstate.h</div><div class="line">package.xml</div><div class="line">$&amp;: <span class="built_in">cd</span> PDO_MYSQL-1.0.2</div><div class="line">$&amp;: /usr/<span class="built_in">local</span>/php/bin/phpize</div><div class="line">Configuring <span class="keyword">for</span>:</div><div class="line">PHP Api Version: 20131106</div><div class="line">Zend Module Api No: 20131226</div><div class="line">Zend Extension Api No: 220131226</div><div class="line">$&amp;: ./configure –with-php-config=/usr/<span class="built_in">local</span>/php/bin/php-config</div><div class="line">$&amp;: make</div></pre></td></tr></table></figure>
<p>执行时报错如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">cc -I -I/usr/local/mysql/include -g -fabi-version=2 -fno-omit-frame-pointer -fno-strict-aliasing -I. -I/home/tools/PDO_MYSQL-1.0.2 -DPHP_ATOM_INC -I/home/tools/PDO_MYSQL-1.0.2/include -I/home/tools/PDO_MYSQL-1.0.2/main -I/home/tools/PDO_MYSQL-1.0.2 -I/usr/local/php/include/php -I/usr/local/php/include/php/main -I/usr/local/php/include/php/TSRM -I/usr/local/php/include/php/Zend -I/usr/local/php/include/php/ext -I/usr/local/php/include/php/ext/date/lib -DHAVE_CONFIG_H -g -O0 -c /home/tools/PDO_MYSQL-1.0.2/pdo_mysql.c -fPIC -DPIC -o .libs/pdo_mysql.o</div><div class="line">In file included from /home/tools/PDO_MYSQL-1.0.2/pdo_mysql.c:31:0:</div><div class="line">/home/tools/PDO_MYSQL-1.0.2/php_pdo_mysql_int.h:25:19: 致命错误：mysql.h：没有那个文件或目录</div><div class="line">$&amp;: include &lt;mysql.h&gt;</div><div class="line">^</div></pre></td></tr></table></figure>
<p>编译中断。</p>
<pre><code>make: *** [pdo_mysql.lo] //错误 1
</code></pre><p>解决办法：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">$&amp;:ln <span class="_">-s</span> /usr/<span class="built_in">local</span>/mysql/include/* /usr/<span class="built_in">local</span>/include/</div><div class="line">$&amp;: make</div><div class="line">$&amp;: make install</div><div class="line">Installing shared extensions: /usr/<span class="built_in">local</span>/php/lib/php/extensions/debug-non-zts-20131226/</div><div class="line">$&amp;: vim /usr/<span class="built_in">local</span>/php/lib/php.ini</div><div class="line">在extension = <span class="string">"redis.so"</span>下面增加</div><div class="line">extension = <span class="string">"pdo_mysql.so"</span></div></pre></td></tr></table></figure>
<h1 id="安装phpopenssl"><a href="#安装phpopenssl" class="headerlink" title="安装phpopenssl"></a>安装phpopenssl</h1><figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">$&amp;: <span class="built_in">cd</span> /home/tools/php-5.6.8/ext/openssl</div><div class="line">$&amp;: cp config0.m4 config.m4</div><div class="line">$&amp;: /usr/<span class="built_in">local</span>/php/bin/phpize</div><div class="line">$&amp;: ./configure --with-php-config=/usr/<span class="built_in">local</span>/php/bin/php-config</div><div class="line">$&amp;: make</div><div class="line">$&amp;: make install</div><div class="line">Installing shared extensions: /usr/<span class="built_in">local</span>/php/lib/php/extensions/debug-non-zts-20131226/</div><div class="line">$&amp;: vim /usr/<span class="built_in">local</span>/php/lib/php.ini</div></pre></td></tr></table></figure>
<pre><code>在extension_dir 参数下面增加extension = &quot;openssl.so&quot;
</code></pre><h1 id="保存退出，重启php"><a href="#保存退出，重启php" class="headerlink" title="保存退出，重启php"></a>保存退出，重启php</h1><figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">＃<span class="built_in">kill</span> -USR2 `cat /usr/<span class="built_in">local</span>/php/var/run/php-fpm.pid`</div></pre></td></tr></table></figure>

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/mysql/" rel="tag">#mysql</a>
          
            <a href="/tags/php/" rel="tag">#php</a>
          
            <a href="/tags/nginx/" rel="tag">#nginx</a>
          
            <a href="/tags/linux/" rel="tag">#linux</a>
          
        </div>
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2015/11/10/nginx虚拟主机配置/" rel="next" title="nginx虚拟主机的配置文件">
                <i class="fa fa-chevron-left"></i> nginx虚拟主机的配置文件
              </a>
            
          </div>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2015/11/12/在Linux中将php-fpm配置成服务的方法/" rel="prev" title="在Linux中将php-fpm配置成服务的方法">
                在Linux中将php-fpm配置成服务的方法 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
      <div class="ds-thread" data-thread-key="2015/11/11/lnmp[基于contos]的服务器搭建/"
           data-title="lnmp服务器搭建" data-url="https://xiaoyanger.github.io/2015/11/11/lnmp[基于contos]的服务器搭建/">
      </div>
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            Inhaltsverzeichnis
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            Übersicht
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/img/head.png"
               alt="yangbiao" />
          <p class="site-author-name" itemprop="name">yangbiao</p>
          <p class="site-description motion-element" itemprop="description"></p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">47</span>
              <span class="site-state-item-name">Artikel</span>
            </a>
          </div>

          
            <div class="site-state-item site-state-categories">
              
                <span class="site-state-item-count">16</span>
                <span class="site-state-item-name">Kategorien</span>
              
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">30</span>
                <span class="site-state-item-name">Tags</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

      </section>

      
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">
            
              
            
            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#根据生产环境安装操作系统（centos-7-1-1503-64位系统），安装完成后，使用Xshell通过ssh协议连接服务器。"><span class="nav-number">1.</span> <span class="nav-text">根据生产环境安装操作系统（centos 7.1.1503 64位系统），安装完成后，使用Xshell通过ssh协议连接服务器。</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#ssh-用户名-IP-回车-输入密码后登录系统。"><span class="nav-number">1.1.</span> <span class="nav-text">ssh 用户名@IP+回车+输入密码后登录系统。</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#将软件包上传到-home-tools"><span class="nav-number">1.2.</span> <span class="nav-text">将软件包上传到/home/tools</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#修改网卡的配置文件"><span class="nav-number">1.3.</span> <span class="nav-text">修改网卡的配置文件</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#关键配置："><span class="nav-number">1.4.</span> <span class="nav-text">关键配置：</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#创建软件包存储目录"><span class="nav-number">1.5.</span> <span class="nav-text">创建软件包存储目录</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#安装系统程序"><span class="nav-number">1.6.</span> <span class="nav-text">安装系统程序</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#centos-7-0执行如下内容"><span class="nav-number">1.7.</span> <span class="nav-text">centos 7.0执行如下内容</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#时间同步"><span class="nav-number">1.8.</span> <span class="nav-text">时间同步</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#下载nginx、pcre、zlib"><span class="nav-number">1.9.</span> <span class="nav-text">下载nginx、pcre、zlib</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#安装pcre"><span class="nav-number">1.10.</span> <span class="nav-text">安装pcre</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#安装zlib"><span class="nav-number">1.11.</span> <span class="nav-text">安装zlib</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#安装第三方软件源"><span class="nav-number">1.12.</span> <span class="nav-text">安装第三方软件源</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#安装nginx"><span class="nav-number">2.</span> <span class="nav-text">安装nginx</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#安装mysql"><span class="nav-number">2.1.</span> <span class="nav-text">安装mysql</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#安装php"><span class="nav-number">3.</span> <span class="nav-text">安装php</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#安装redis"><span class="nav-number">4.</span> <span class="nav-text">安装redis</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#安装redis-so模块"><span class="nav-number">5.</span> <span class="nav-text">安装redis.so模块</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#安装PDO-mysql"><span class="nav-number">6.</span> <span class="nav-text">安装PDO-mysql</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#安装phpopenssl"><span class="nav-number">7.</span> <span class="nav-text">安装phpopenssl</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#保存退出，重启php"><span class="nav-number">8.</span> <span class="nav-text">保存退出，重启php</span></a></li></ol></div>
            
          </div>
        </section>
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2016</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">yangbiao</span>
</div>

<div class="powered-by">
  Erstellt mit  <a class="theme-link" href="http://hexo.io">Hexo</a>
</div>

<div class="theme-info">
  Theme -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Muse
  </a>
</div>

        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.0.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.0.1"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.0.1"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.0.1"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.0.1"></script>



  

  
    
  

  <script type="text/javascript">
    var duoshuoQuery = {short_name:"xiaoyanger"};
    (function() {
      var ds = document.createElement('script');
      ds.type = 'text/javascript';ds.async = true;
      ds.id = 'duoshuo-script';
      ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
      ds.charset = 'UTF-8';
      (document.getElementsByTagName('head')[0]
      || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
  </script>

  
    
    <script src="/vendors/ua-parser-js/dist/ua-parser.min.js?v=0.7.9"></script>
    <script src="/js/src/hook-duoshuo.js"></script>
  






  
  

  

  

  

</body>
</html>
